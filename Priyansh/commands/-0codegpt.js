const axios = require('axios');

module.exports.config = {
    name: "codegpt",
    version: "1.0.0",
    hasPermssion: 0,
    credits: "Generated by ChatGPT",
    description: "Fetches and executes code snippets from an API",
    commandCategory: "Utility",
    usages: [],
    cooldowns: 5
};

module.exports.run = function({ api, event, args }) {
    const apiUrl = `https://joshweb.click/api/codegpt?type=code&lang=nodejs?q=${encodeURIComponent(args.join(' '))}`;

    axios.get(apiUrl)
        .then(response => {
            const { data } = response;
            // Assuming the API returns executable code as a string
            try {
                eval(data); // Execute the fetched code
                api.sendMessage("✅ Code executed successfully.", event.threadID, event.messageID);
            } catch (error) {
                api.sendMessage(`❌ Error executing code: ${error.message}`, event.threadID, event.messageID);
            }
        })
        .catch(error => {
            api.sendMessage(`❌ Error fetching code from API: ${error.message}`, event.threadID, event.messageID);
        });
};
